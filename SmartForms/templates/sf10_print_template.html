<!DOCTYPE html>
{% load static %}
<html>

<head>
    <meta charset="UTF-8">
    <title>SF10 - {{ student.lrn }}</title>
    <style>
        @page {
            size: letter portrait;
            margin: 0.3cm;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Arial", sans-serif;
            font-size: 7.5pt;
            line-height: 1.1;
            color: #000;
        }

        .page {
            page-break-after: always;
            padding: 5px;
            position: relative;
            min-height: 26cm;
        }

        .page:last-child {
            page-break-after: auto;
        }

        /* Official Header Style */
        .official-header {
            width: 100%;
            margin-bottom: 5px;
        }

        .official-header table {
            width: 100%;
            border: none;
        }

        .official-header td {
            border: none;
            padding: 0;
            vertical-align: middle;
        }

        .header-text {
            text-align: center;
        }

        .header-text h1 {
            font-size: 11pt;
            font-weight: bold;
            margin-bottom: 1px;
        }

        .header-text h2 {
            font-size: 8pt;
            font-weight: normal;
        }

        .form-title {
            text-align: center;
            font-size: 11pt;
            font-weight: bold;
            margin: 5px 0;
            text-transform: uppercase;
        }

        .form-subtitle {
            text-align: center;
            font-size: 7pt;
            font-style: italic;
            margin-bottom: 5px;
        }

        /* Section Styling */
        .section-header {
            background-color: #000;
            color: #fff;
            font-weight: bold;
            padding: 2px 5px;
            font-size: 8pt;
            margin-top: 5px;
        }

        .info-grid {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 3px;
        }

        .info-grid td {
            border: 1px solid #000;
            padding: 2px 4px;
        }

        .label {
            font-weight: bold;
            font-size: 7pt;
            white-space: nowrap;
        }

        .value {
            border-bottom: 0.5px solid #000;
            min-width: 50px;
            display: inline-block;
            padding: 0 5px;
        }

        /* Scholastic Record Box */
        .scholastic-box {
            border: 1.5px solid #000;
            margin-top: 5px;
            padding: 3px;
        }

        .scholastic-header {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
            margin-bottom: 3px;
        }

        .header-item {
            display: flex;
            align-items: baseline;
        }

        table.grades-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 7pt;
        }

        table.grades-table th,
        table.grades-table td {
            border: 1px solid #000;
            padding: 1.5px 3px;
            text-align: center;
        }

        table.grades-table th {
            font-weight: bold;
            background-color: #f2f2f2;
        }

        table.grades-table td.subject {
            text-align: left;
            width: 40%;
        }

        /* Action Taken Box */
        .action-box {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            border: 1px solid #000;
            margin-top: -1px;
            padding: 3px;
            font-size: 7pt;
        }

        /* Remedial Box */
        .remedial-box {
            border: 1px solid #000;
            margin-top: 3px;
            padding: 3px;
            background-color: #fafafa;
        }

        /* Certification */
        .certification-grid {
            margin-top: 10px;
            width: 100%;
            border-collapse: collapse;
        }

        .certification-grid td {
            vertical-align: top;
            padding: 5px;
        }

        .sig-line {
            border-top: 1px solid #000;
            margin-top: 25px;
            text-align: center;
            font-weight: bold;
            font-size: 7.5pt;
        }

        .checkbox {
            display: inline-block;
            width: 10px;
            height: 10px;
            border: 1px solid #000;
            margin-right: 2px;
            vertical-align: middle;
            text-align: center;
            line-height: 10px;
            font-size: 8pt;
        }

        .watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 80pt;
            color: rgba(0, 0, 0, 0.05);
            z-index: -1;
            font-weight: bold;
            white-space: nowrap;
        }
    </style>
</head>

<body>
    <!-- PAGE 1: FRONT -->
    <div class="page">
        <div class="watermark">SF10-JHS</div>

        <div class="official-header">
            <table>
                <tr>
                    <td style="width: 12%;"><img src="{% static 'depedkag.PNG' %}" style="height: 55px;"></td>
                    <td class="header-text">
                        <h2>Republic of the Philippines</h2>
                        <h1>Department of Education</h1>
                    </td>
                    <td style="width: 12%; text-align: right;"><img src="{% static 'logo.png' %}" style="height: 55px;">
                    </td>
                </tr>
            </table>
        </div>

        <div class="form-title">LEARNER PERMANENT ACADEMIC RECORD FOR JUNIOR HIGH SCHOOL (SF10-JHS)</div>
        <div class="form-subtitle">(Formerly Form 137) | Revised based on DO No. 10, s. 2024</div>

        <div class="section-header">LEARNER'S PERSONAL INFORMATION</div>
        <table class="info-grid" style="border: none;">
            <tr style="border: none;">
                <td style="border: none; width: 45%;"><span class="label">LAST NAME:</span> <span class="value"
                        style="width: 70%;">{{ student.last_name|upper }}</span></td>
                <td style="border: none; width: 40%;"><span class="label">FIRST NAME:</span> <span class="value"
                        style="width: 70%;">{{ student.first_name|upper }}</span></td>
                <td style="border: none;"><span class="label">M.N:</span> <span class="value" style="width: 30%;">{{ student.middle_name|slice:":1"|upper|default:"" }}</span></td>
            </tr>
        </table>
        <table class="info-grid" style="border: none;">
            <tr style="border: none;">
                <td style="border: none; width: 30%;"><span class="label">LRN:</span> <span class="value"
                        style="width: 60%;">{{ student.lrn }}</span></td>
                <td style="border: none; width: 25%;"><span class="label">Birthdate:</span> <span class="value">{{ student.birthdate|date:"m/d/Y" }}</span></td>
                <td style="border: none; width: 20%;"><span class="label">Sex:</span> <span class="value">{{ student.get_sex_display }}</span></td>
                <td style="border: none;"><span class="label">Name Ext:</span> <span class="value">{{ student.name_extension|default:"N/A" }}</span></td>
            </tr>
        </table>

        <div class="section-header">ELIGIBILITY FOR JUNIOR HIGH SCHOOL ENROLLMENT</div>
        <div style="padding: 3px; border: 1px solid #000; font-size: 7pt; line-height: 1.4;">
            <div>
                <span class="checkbox">{% if student.credential_presented == 'KINDER_CERTIFICATE' or student.credential_presented == 'KINDER_PROGRESS' %}✓{% endif %}</span> Elementary School Graduate
                &nbsp;&nbsp;&nbsp; High School Year Completed: <span class="value" style="width: 40px;"></span>
                &nbsp;&nbsp;&nbsp; Gen. Average: <span class="value" style="width: 30px;"></span>
            </div>
            <div>
                Name of Elementary School: <span class="value" style="width: 250px;"></span>
                &nbsp;&nbsp;&nbsp; School ID: <span class="value" style="width: 60px;"></span>
            </div>
            <div>
                <span class="checkbox">{% if student.credential_presented == 'PEPT' %}✓{% endif %}</span> PEPT Passer
                &nbsp;&nbsp;&nbsp; Rating: <span class="value">{{ student.pept_rating|default:"" }}</span>
                &nbsp;&nbsp;&nbsp; Date of Exam: <span class="value">{{ student.pept_date|date:"m/d/Y"|default:"" }}</span>
            </div>
            <div>
                <span class="checkbox">{% if student.credential_presented == 'OTHER' %}✓{% endif %}</span> Other
                (Specify): <span class="value" style="width: 200px;">{{ student.other_credential }}</span>
            </div>
        </div>

        <div class="section-header">SCHOLASTIC RECORD</div>

        {% for page in pages %}
        {% if forloop.first %}
        {% for record in page|slice:":2" %}
        <div class="scholastic-box">
            <div class="scholastic-header">
                <div class="header-item"><span class="label">School:</span> <span class="value" style="flex:1;">{{ school.name }}</span></div>
                <div class="header-item"><span class="label">School ID:</span> <span class="value" style="width: 60px;">{{ school.school_id }}</span></div>
                <div class="header-item"><span class="label">District:</span> <span class="value" style="flex:1;">{{ school.district }}</span></div>
                <div class="header-item"><span class="label">Division:</span> <span class="value" style="flex:1;">{{ school.division }}</span></div>
                <div class="header-item"><span class="label">Region:</span> <span class="value" style="width: 40px;">{{ school.region }}</span></div>
                <div class="header-item"><span class="label">Class:</span> <span class="value" style="width: 80px;">Grade {{ record.grade_level }} - {{ record.section }}</span></div>
                <div class="header-item"><span class="label">School Year:</span> <span class="value" style="width: 80px;">{{ record.school_year }}</span></div>
                <div class="header-item"><span class="label">Adviser:</span> <span class="value" style="flex:1;">{{ record.adviser_teacher.get_full_name|default:record.adviser_teacher.username }}</span></div>
            </div>
            <table class="grades-table">
                <thead>
                    <tr>
                        <th rowspan="2" class="subject">LEARNING AREAS</th>
                        <th colspan="4" style="width: 20%;">Quarterly Rating</th>
                        <th rowspan="2" style="width: 8%;">Final<br>Rating</th>
                        <th rowspan="2" style="width: 12%;">Remarks</th>
                    </tr>
                    <tr>
                        <th style="width: 5%;">1</th>
                        <th style="width: 5%;">2</th>
                        <th style="width: 5%;">3</th>
                        <th style="width: 5%;">4</th>
                    </tr>
                </thead>
                <tbody>
                    {% for grade in record.subject_grades.all %}
                    <tr>
                        <td class="subject">{{ grade.learning_area.name }}</td>
                        <td>{{ grade.quarter_1|default:"" }}</td>
                        <td>{{ grade.quarter_2|default:"" }}</td>
                        <td>{{ grade.quarter_3|default:"" }}</td>
                        <td>{{ grade.quarter_4|default:"" }}</td>
                        <td><strong>{{ grade.final_rating|default:"" }}</strong></td>
                        <td>{{ grade.remarks|default:"" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <div class="action-box">
                <div><span class="label">General Average:</span> <span class="value"
                        style="width: 40px; font-weight: bold;">{{ record.general_average|default:"" }}</span></div>
                <div><span class="label">Action Taken:</span> <span class="value"
                        style="width: 80px; font-weight: bold;">{{ record.remarks|default:"" }}</span></div>
            </div>

            {% if record.get_subjects_for_remedial %}
            <div class="remedial-box">
                <div style="font-weight: bold; font-size: 6.5pt; margin-bottom: 2px;">Remedial Classes</div>
                <table class="grades-table">
                    <tr>
                        <th>Learning Area</th>
                        <th>Final Rating</th>
                        <th>Remedial Mark</th>
                        <th>Recomputed Grade</th>
                        <th>Remarks</th>
                    </tr>
                    {% for gr in record.get_subjects_for_remedial %}
                    <tr>
                        <td class="subject">{{ gr.learning_area.name }}</td>
                        <td>{{ gr.final_rating }}</td>
                        <td>{{ gr.remedial_mark|default:"" }}</td>
                        <td>{{ gr.recomputed_final_grade|default:"" }}</td>
                        <td>{{ gr.remarks }}</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
            {% endif %}
        </div>
        {% endfor %}
        {% endif %}
        {% endfor %}
    </div>

    <!-- PAGE 2: BACK (Grade 9 & 10 + Certification) -->
    {% for page in pages %}
    {% if forloop.first %}
    {% if page|length > 2 %}
    <div class="page">
        <div class="watermark">SF10-JHS</div>

        {% for record in page|slice:"2:" %}
        <div class="scholastic-box">
            <div class="scholastic-header">
                <div class="header-item"><span class="label">School:</span> <span class="value" style="flex:1;">{{ school.name }}</span></div>
                <div class="header-item"><span class="label">School ID:</span> <span class="value"
                        style="width: 60px;">{{ school.school_id }}</span></div>
                <div class="header-item"><span class="label">Class:</span> <span class="value"
                        style="width: 100px;">Grade {{ record.grade_level }} - {{ record.section }}</span></div>
                <div class="header-item"><span class="label">School Year:</span> <span class="value"
                        style="width: 80px;">{{ record.school_year }}</span></div>
                <div class="header-item"><span class="label">Adviser:</span> <span class="value" style="flex:1;">{{ record.adviser_teacher.get_full_name|default:record.adviser_teacher.username }}</span></div>
            </div>

            <table class="grades-table">
                <thead>
                    <tr>
                        <th rowspan="2" class="subject">LEARNING AREAS</th>
                        <th colspan="4">Quarterly Rating</th>
                        <th rowspan="2">Final</th>
                        <th rowspan="2">Remarks</th>
                    </tr>
                    <tr>
                        <th>1</th>
                        <th>2</th>
                        <th>3</th>
                        <th>4</th>
                    </tr>
                </thead>
                <tbody>
                    {% for grade in record.subject_grades.all %}
                    <tr>
                        <td class="subject">{{ grade.learning_area.name }}</td>
                        <td>{{ grade.quarter_1|default:"" }}</td>
                        <td>{{ grade.quarter_2|default:"" }}</td>
                        <td>{{ grade.quarter_3|default:"" }}</td>
                        <td>{{ grade.quarter_4|default:"" }}</td>
                        <td><strong>{{ grade.final_rating|default:"" }}</strong></td>
                        <td>{{ grade.remarks|default:"" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <div class="action-box">
                <div><span class="label">General Average:</span> <span class="value"
                        style="width: 40px; font-weight: bold;">{{ record.general_average|default:"" }}</span></div>
                <div><span class="label">Action Taken:</span> <span class="value"
                        style="width: 80px; font-weight: bold;">{{ record.remarks|default:"" }}</span></div>
            </div>
        </div>
        {% endfor %}

        <div class="section-header">CERTIFICATION</div>
        <div style="border: 1px solid #000; padding: 10px; font-size: 8pt; line-height: 1.5; margin-top: 5px;">
            I CERTIFY that this is a true record of <strong>{{ student.get_full_name|upper }}</strong> with LRN
            <strong>{{ student.lrn }}</strong> and that he/she is eligible for admission to Grade <span class="value" style="width: 40px;"></span>.

            <table class="certification-grid">
                <tr>
                    <td style="width: 50%;">
                        <div>Date: <span class="value" style="width: 120px;">{{ generated_date|date:"F d, Y" }}</span>
                        </div>
                        <div style="margin-top: 5px;">School Name: <span class="value" style="width: 150px;">{{ school.name }}</span></div>
                        <div style="margin-top: 5px;">School ID: <span class="value" style="width: 80px;">{{ school.school_id }}</span></div>
                    </td>
                    <td style="width: 50%;">
                        <div class="sig-line">School Head/Principal</div>
                        <div style="text-align: center; font-size: 6pt; color: #666;">(Signature over Printed Name)
                        </div>
                        <div
                            style="text-align: center; margin-top: 15px; border: 1px dashed #ccc; padding: 20px; font-size: 7pt; color: #ccc;">
                            (Affix School Seal here)</div>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    {% endif %}
    {% endif %}
    {% endfor %}

    <!-- CONTINUATION PAGES (Page 3+) -->
    {% for page in pages %}
    {% if not forloop.first %}
    <div class="page">
        <div class="watermark">SF10-JHS</div>
        <div class="form-title" style="font-size: 9pt;">LEARNER PERMANENT ACADEMIC RECORD - CONTINUATION</div>

        {% for record in page %}
        <div class="scholastic-box">
            <div class="scholastic-header">
                <div class="header-item"><span class="label">School:</span> <span class="value" style="flex:1;">{{ school.name }}</span></div>
                <div class="header-item"><span class="label">School ID:</span> <span class="value" style="width: 60px;">{{ school.school_id }}</span></div>
                <div class="header-item"><span class="label">Class:</span> <span class="value" style="width: 100px;">Grade {{ record.grade_level }} - {{ record.section }}</span></div>
                <div class="header-item"><span class="label">School Year:</span> <span class="value" style="width: 80px;">{{ record.school_year }}</span></div>
                <div class="header-item"><span class="label">Adviser:</span> <span class="value" style="flex:1;">{{ record.adviser_teacher.get_full_name|default:record.adviser_teacher.username }}</span></div>
            </div>

            <table class="grades-table">
                <thead>
                    <tr>
                        <th rowspan="2" class="subject">LEARNING AREAS</th>
                        <th colspan="4">Quarterly Rating</th>
                        <th rowspan="2">Final</th>
                        <th rowspan="2">Remarks</th>
                    </tr>
                    <tr>
                        <th>1</th>
                        <th>2</th>
                        <th>3</th>
                        <th>4</th>
                    </tr>
                </thead>
                <tbody>
                    {% for grade in record.subject_grades.all %}
                    <tr>
                        <td class="subject">{{ grade.learning_area.name }}</td>
                        <td>{{ grade.quarter_1|default:"" }}</td>
                        <td>{{ grade.quarter_2|default:"" }}</td>
                        <td>{{ grade.quarter_3|default:"" }}</td>
                        <td>{{ grade.quarter_4|default:"" }}</td>
                        <td><strong>{{ grade.final_rating|default:"" }}</strong></td>
                        <td>{{ grade.remarks|default:"" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <div class="action-box">
                <div><span class="label">General Average:</span> <span class="value"
                        style="width: 40px; font-weight: bold;">{{ record.general_average|default:"" }}</span></div>
                <div><span class="label">Action Taken:</span> <span class="value"
                        style="width: 80px; font-weight: bold;">{{ record.remarks|default:"" }}</span></div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% endfor %}

</body>

</html>